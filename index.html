<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#1e1e1e">
<title>Dolomitas â€“ Tu Mapa</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="map"></div>

<div class="topbar">
  <div class="search-wrap">
    <input id="search" placeholder="Buscar lugar... (ej. Tre Cime)"/>
    <button id="clearBtn" title="Limpiar bÃºsqueda">âœ–</button>
  </div>
  <div class="chips" id="chips"></div>
</div>

<div class="fab">
  <button class="btn" id="listToggleBtn" title="Mostrar/Ocultar lista">ğŸ—‚ï¸</button>
  <button class="btn" id="locateBtn" title="Mi ubicaciÃ³n">ğŸ“</button>
  <button class="btn" id="resetBtn" title="Ver todo">ğŸ”</button>
  <button class="btn" id="installBtn" title="Instalar app" style="display:none">â¬‡ï¸</button>
</div>

<div class="sidebar hidden" id="sidebar">
  <div id="list"></div>
  <div class="legend" id="legend"></div>
</div>

<div class="footer">Dolomitas Map â€¢ Funciona offline (capa base necesita conexiÃ³n)</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script src="app.js"></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
}
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  const btn = document.getElementById('installBtn');
  btn.style.display = 'block';
  btn.addEventListener('click', async () => {
    btn.style.display = 'none';
    if (deferredPrompt) {
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
    }
  }, { once:true });
});
</script>
</body>
</html>
